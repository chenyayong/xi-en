(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/detail"],{"1e0b":function(t,e,n){"use strict";var r=n("2b81"),o=n.n(r);o.a},"2b81":function(t,e,n){},"37a3":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n("a34a")),o=n("6578"),a=n("4de8");function i(t){return t&&t.__esModule?t:{default:t}}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e,n,r,o,a,i){try{var u=t[a](i),c=u.value}catch(s){return void n(s)}u.done?e(c):Promise.resolve(c).then(r,o)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){d(a,r,o,i,u,"next",t)}function u(t){d(a,r,o,i,u,"throw",t)}i(void 0)}))}}var l=function(){Promise.all([n.e("common/vendor"),n.e("components/jyf-parser/jyf-parser")]).then(function(){return resolve(n("5b50"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("pages/product/components/detail-page-header").then(function(){return resolve(n("2a86"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("pages/product/components/mix-swiper").then(function(){return resolve(n("2cd4"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("pages/rating/components/rating-item").then(function(){return resolve(n("2c02"))}.bind(null,n)).catch(n.oe)},g=function(){Promise.all([n.e("common/vendor"),n.e("pages/product/components/bottom-operation")]).then(function(){return resolve(n("f054"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("pages/product/components/sku").then(function(){return resolve(n("5b5f"))}.bind(null,n)).catch(n.oe)},v={components:{jyfParser:l,pageHeader:p,mixSwiper:h,ratingItem:m,bottomOperation:g,sku:b},data:function(){return{currentSku:{},data:{images:[]},ratingData:{}}},onLoad:function(t){this.id=t.id,this.loadRating()},onShow:function(){this.loadData()},onPageScroll:function(t){this.$refs.pageHeader&&this.$refs.pageHeader.pageScroll(t)},onShareAppMessage:function(t){return{title:this.data.title,path:"/pages/product/detail?id="+this.data.id,imageUrl:this.$config.domain+this.data.thumb}},methods:{loadData:function(){var e=this;return f(r.default.mark((function n(){var a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,o.getGoodsInfo)({id:e.id});case 2:if(a=n.sent,0!==a.status){n.next=7;break}return e.$util.msg(a.msg||"产品不存在或已下架"),setTimeout((function(){t.navigateBack()}),1e3),n.abrupt("return");case 7:e.data.images=a.result.goods_images_list,e.data.title=a.result.goods.goods_name,e.data.market_price=a.result.goods.market_price,e.data.price=a.result.goods.shop_price,e.data.sales=a.result.goods.sales_sum,e.data.stock=a.result.goods.store_count,e.data.look_num=a.result.goods.click_count,e.data.thumb=a.result.goods.original_img,e.data.fav=a.result.collect||0,e.ratingData.count=a.result.goods.comment_count,e.data.content=a.result.goods.goods_content,e.data.id=e.id,e.data.skuData={specList:a.result.filter_spec,attrList:[]},e.data.sku=a.result.spec_goods_price,e.$nextTick((function(){e.calcAnchor()}));case 22:case"end":return n.stop()}}),n)})))()},loadRating:function(){return f(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},addToCart:function(){var t=this;this.$util.throttle(f(r.default.mark((function e(){var n,o;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$util.isLogin()){e.next=2;break}return e.abrupt("return");case 2:return n=c(c({},t.data),{},{sku:{name:t.currentSku.name,id:t.currentSku.id},number:t.$refs.skuPopup.buyNumber||1,checked:!0}),t.currentSku&&t.currentSku.price&&(n.price=t.currentSku.price),e.next=6,(0,a.addCartOrders)(n);case 6:o=e.sent,t.$util.msg(o.msg),1===o.status&&(t.hidePopup("skuPopup"),t.$store.commit("setStateAttr",{key:"cartOrders",val:o.result}));case 9:case"end":return e.stop()}}),e)}))))},buyNow:function(){var t=this;this.hidePopup("skuPopup"),this.navTo("/pages/order/createOrder",{login:!0,success:function(e){var n=c(c({},t.data),{},{sku:{name:t.currentSku.name,id:t.currentSku.id},number:t.$refs.skuPopup.buyNumber||1});t.currentSku&&t.currentSku.price&&(n.price=t.currentSku.price),e.eventChannel.emit("goodsData",[n])}})},setCurrentSku:function(t){this.currentSku=t},getConfirmData:function(){if(this.data.stock<=0)return this.$util.msg("库存不足"),!1;var t={goods_id:this.data.id,number:this.$refs.skuPopup.buyNumber||1};return t},calcAnchor:function(){var e=this;return f(r.default.mark((function n(){var o,a,i,u;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(e){t.createSelectorQuery().select("#rating").boundingClientRect((function(t){e(t)})).exec()}));case 2:o=n.sent,a=e.systemInfo.statusBarHeight+e.systemInfo.navigationBarHeight,i=(o?o.top:0)-a,u=(o?o.bottom:0)+t.upx2px(12)-a,e.$refs.pageHeader.anchorList[1].top=i,e.$refs.pageHeader.anchorList[2].top=u,[0,i,u];case 9:case"end":return n.stop()}}),n)})))()},addProductHistory:function(){var e=this.data,n=t.getStorageSync("productHistory");n||(n=[]);var r=n.findIndex((function(t){return t.id===e._id}));-1!==r&&n.splice(r,1),n.unshift({id:e._id,thumb:e.thumb}),t.setStorageSync("productHistory",n)},delHistory:function(){var e=t.getStorageSync("productHistory");if(e){var n=e.findIndex((function(t){return t._id===data._id}));-1!==n&&(e.splice(n,1),t.setStorageSync("productHistory",e))}},showPopup:function(t,e){this.$refs[t]&&this.$refs[t].open(e)},onOprationClick:function(t){this.showPopup("skuPopup",t)},doAppShare:function(){var e=this;this.$util.throttle(f(r.default.mark((function n(){var o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o={provider:"weixin",scene:"WXSceneSession",type:5,imageUrl:e.data.thumb,title:e.data.title,miniProgram:{id:"gh_3dada2e0f833",path:"/pages/product/detail?id="+e.data._id,type:0,webUrl:"http://guoyunnet.com"},success:function(t){console.log("success:"+JSON.stringify(t))},fail:function(t){console.log("fail:"+JSON.stringify(t))}},t.share(o);case 2:case"end":return n.stop()}}),n)}))))}}};e.default=v}).call(this,n("543d")["default"])},"442d":function(t,e,n){"use strict";(function(t){n("f37f");r(n("66fd"));var e=r(n("bd20"));function r(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},4612:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return r}));var r={mixPriceView:function(){return n.e("components/mix-price-view/mix-price-view").then(n.bind(null,"7cca"))},jyfParser:function(){return Promise.all([n.e("common/vendor"),n.e("components/jyf-parser/jyf-parser")]).then(n.bind(null,"5b50"))},mixLoading:function(){return n.e("components/mix-loading/mix-loading").then(n.bind(null,"50c5"))}},o=function(){var t=this,e=t.$createElement;t._self._c},a=[]},"6b9f":function(t,e,n){"use strict";var r=n("bbcc"),o=n.n(r);o.a},"896a":function(t,e,n){"use strict";n.r(e);var r=n("37a3"),o=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e["default"]=o.a},bbcc:function(t,e,n){},bd20:function(t,e,n){"use strict";n.r(e);var r=n("4612"),o=n("896a");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("1e0b"),n("6b9f");var i,u=n("f0c5"),c=Object(u["a"])(o["default"],r["b"],r["c"],!1,null,"287860be",null,!1,r["a"],i);e["default"]=c.exports}},[["442d","common/runtime","common/vendor"]]]);